const base64Img=require("base64-img"),os=require("os"),networkInterfaces=os.networkInterfaces();if(networkInterfaces.WiFi)for(let a=0;a<networkInterfaces.WiFi.length;a++)"IPv4"==networkInterfaces.WiFi[a].family&&networkInterfaces.WiFi[a].address&&(window.ip=networkInterfaces.WiFi[a].address);var canvas1=document.createElement("canvas");
function capture(){if(optimal.closest){var a=0;for(let b=0;b<boatPos.length;b++)"SPACE"==boatPos[b]?(getClass("label")[b].getTag("span")[0].style.visibility="hidden",getClass("label")[b].getTag("b")[0].innerText="SPACE",a+=1):(getClass("label")[b].getTag("span")[0].innerText=b-a+1,getClass("label")[b].getTag("b")[0].innerText=boatPos[b].n);html2canvas(get("boat-container")).then(b=>{document.body.appendChild(b);var c=b.getContext("2d"),e=removeBlanks(b,c,b.width,b.height);c=c.getImageData(e.x-10,
e.y-10,e.width+20,e.height+20);canvas1.width=c.width;canvas1.height=c.height;e=canvas1.getContext("2d");e.rect(0,0,c.width,c.height);e.fillStyle="white";e.fill();e.putImageData(c,0,0);c=canvas1.toDataURL("image/png");get("screenshot-img").src=c;get("save-screenshot").href=c;get("save-screenshot").download="untitled.png";window.serverError&&"USRDBLD"==serverError&&(get("btn-share").style.display="none");document.body.removeChild(b);get("add-modal1").style.display="block"});for(a=0;a<boatPos.length;a++)getClass("label")[a].getTag("span")[0].innerText=
a+1,getClass("label")[a].getTag("span")[0].style.visibility="visible",getClass("label")[a].getTag("b")[0].innerText="SPACE"==boatPos[a]?"SPACE":`${boatPos[a].n} (${boatPos[a].w}kg)`}}
var removeBlanks=function(a,b,c,e){var l=b.getImageData(0,0,a.width,a.height).data,m=function(d,g){return{red:l[4*(c*g+d)],green:l[4*(c*g+d)+1],blue:l[4*(c*g+d)+2]}},n=function(d){return 255==d.red&&255==d.green&&255==d.blue||(25==d.red,25==d.green,27==d.blue)},k=function(d){for(var g=d?1:-1,f=d?0:e-1;d?f<e:-1<f;f+=g)for(var h=0;h<c;h++)if(!n(m(h,f)))return f;return null};b=function(d){for(var g=d?1:-1,f=d?0:c-1;d?f<c:-1<f;f+=g)for(var h=0;h<e;h++)if(!n(m(f,h)))return f;return null};a=k(!0);k=k(!1);
var p=b(!0);b=b(!1);return{y:a,height:k-a,x:p,width:b-p}};
function shareImg(){window.ip&&!window.serverError?base64Img.img(get("screenshot-img").src,path.join(__dirname,"img"),"boat",function(a,b){a?alert("An error occured while trying to share files","error"):(alert("Successfully sharing image locally"),alert("In order to view and download this on other devices, those devices must be connected to the same internet as this computer."),alert("Go to http://"+ip+":7409/boat.png in any browser on the connecting device(s). The image should appear."))}):window.ip?
"EADDRINUSE"==serverError.error?alert("An error occured while trying to share files - Another Paddle Balancer app on a different device is already sharing.","error"):alert("An error occured while trying to startup a sharing server.","error"):alert("An error occured while trying to share files - An IPv4 address could not be established.","error")};
